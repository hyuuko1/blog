<!DOCTYPE html>
<html lang="zh-Hans" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>é¡µé¢è¿ç§»ï¼ˆPage Migrationï¼‰ | Blog</title>
    <meta name="description" content="Linux kernel å†…æ ¸ä»£ç åˆ†æï¼ŒåŸç†è¯¦è§£">
    <meta name="generator" content="VitePress v2.0.0-alpha.13">
    <link rel="preload stylesheet" href="/blog/assets/style.Cg8D8EfQ.css" as="style">
    <link rel="preload stylesheet" href="/blog/vp-icons.css" as="style">
    <script type="module" src="/blog/assets/chunks/metadata.e2231c71.js"></script>
    <script type="module" src="/blog/assets/app.DgFSTuZM.js"></script>
    <link rel="preload" href="/blog/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/blog/assets/chunks/theme.3WDp7bvS.js">
    <link rel="modulepreload" href="/blog/assets/chunks/framework.CdzZEkix.js">
    <link rel="modulepreload" href="/blog/assets/mm_page_migration.md.DKmFjHBP.lean.js">
    <link rel="icon" type="image/svg+xml" href="/blog/linux.svg">
    <link rel="icon" type="image/png" href="/blog/linux-32x32.png">
    <meta name="theme-color" content="#5f67ee">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="zh_CN">
    <meta property="og:title" content="é¡µé¢è¿ç§»ï¼ˆPage Migrationï¼‰ | Blog">
    <meta property="og:site_name" content="Linux kernel å†…æ ¸ä»£ç åˆ†æï¼ŒåŸç†è¯¦è§£">
    <meta property="og:url" content="https://hyuuko.vercel.app">
    <meta name="google-site-verification" content="OMML6xlbLb2Asitovo85pbOZGTvYoWaYWYW3ps7083s">
    <meta name="msvalidate.01" content="E3B108A75866D6C18B16BE35E14DE820">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-304c8b69><!--[--><!--]--><!--[--><span tabindex="-1" data-v-10d4d845></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-10d4d845>Skip to content</a><!--]--><!----><header class="VPNav" data-v-304c8b69 data-v-d5bf7c8e><div class="VPNavBar" data-v-d5bf7c8e data-v-8eab0e6d><div class="wrapper" data-v-8eab0e6d><div class="container" data-v-8eab0e6d><div class="title" data-v-8eab0e6d><div class="VPNavBarTitle has-sidebar" data-v-8eab0e6d data-v-d4488dd0><a class="title" href="/blog/" data-v-d4488dd0><!--[--><!--]--><!--[--><img class="VPImage logo" src="/blog/linux.svg" width="20" height="20" alt data-v-ab19afbb><!--]--><span data-v-d4488dd0>Blog</span><!--[--><!--]--></a></div></div><div class="content" data-v-8eab0e6d><div class="content-body" data-v-8eab0e6d><!--[--><!--]--><div class="VPNavBarSearch search" data-v-8eab0e6d><!--[--><!----><div id="local-search"><button type="button" aria-label="æœç´¢æ–‡æ¡£" aria-keyshortcuts="/ control+k meta+k" class="DocSearch DocSearch-Button"><span class="DocSearch-Button-Container"><span class="vpi-search DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">æœç´¢æ–‡æ¡£</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key"></kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-8eab0e6d data-v-020be4db><span id="main-nav-aria-label" class="visually-hidden" data-v-020be4db> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/blog/mm/index" tabindex="0" data-v-020be4db data-v-81dba28a><!--[--><span data-v-81dba28a>å†…å­˜ç®¡ç†</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/net/index" tabindex="0" data-v-020be4db data-v-81dba28a><!--[--><span data-v-81dba28a>ç½‘ç»œ</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/storage/index" tabindex="0" data-v-020be4db data-v-81dba28a><!--[--><span data-v-81dba28a>å­˜å‚¨</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/process/index" tabindex="0" data-v-020be4db data-v-81dba28a><!--[--><span data-v-81dba28a>è¿›ç¨‹</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/sched/index" tabindex="0" data-v-020be4db data-v-81dba28a><!--[--><span data-v-81dba28a>è°ƒåº¦</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/irq/index" tabindex="0" data-v-020be4db data-v-81dba28a><!--[--><span data-v-81dba28a>ä¸­æ–­</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/arch/index" tabindex="0" data-v-020be4db data-v-81dba28a><!--[--><span data-v-81dba28a>ä½“ç³»ç»“æ„</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/debug/index" tabindex="0" data-v-020be4db data-v-81dba28a><!--[--><span data-v-81dba28a>è°ƒè¯•</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/virtualization/index" tabindex="0" data-v-020be4db data-v-81dba28a><!--[--><span data-v-81dba28a>è™šæ‹ŸåŒ–</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-020be4db data-v-d8fae6e2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-d8fae6e2><span class="text" data-v-d8fae6e2><!----><span data-v-d8fae6e2>æ‚é¡¹</span><span class="vpi-chevron-down text-icon" data-v-d8fae6e2></span></span></button><div class="menu" data-v-d8fae6e2><div class="VPMenu" data-v-d8fae6e2 data-v-fcd1d7a8><div class="items" data-v-fcd1d7a8><!--[--><!--[--><div class="VPMenuLink" data-v-fcd1d7a8 data-v-acfa8338><a class="VPLink link" href="/blog/other/index" data-v-acfa8338><!--[--><span data-v-acfa8338>å…¶ä»–</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-fcd1d7a8 data-v-acfa8338><a class="VPLink link" href="/blog/init/index" data-v-acfa8338><!--[--><span data-v-acfa8338>åˆå§‹åŒ–</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-fcd1d7a8 data-v-acfa8338><a class="VPLink link" href="/blog/pm/index" data-v-acfa8338><!--[--><span data-v-acfa8338>ç”µæºç®¡ç†</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-8eab0e6d data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-8eab0e6d data-v-ef6192dc data-v-a1a7286e><!--[--><a class="VPSocialLink no-icon" href="https://github.com/hyuuko1/blog" aria-label="github" target="_blank" rel="me noopener" data-v-a1a7286e data-v-32d78712><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-8eab0e6d data-v-600b50c9 data-v-d8fae6e2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-d8fae6e2><span class="vpi-more-horizontal icon" data-v-d8fae6e2></span></button><div class="menu" data-v-d8fae6e2><div class="VPMenu" data-v-d8fae6e2 data-v-fcd1d7a8><!----><!--[--><!--[--><!----><div class="group" data-v-600b50c9><div class="item appearance" data-v-600b50c9><p class="label" data-v-600b50c9>ä¸»é¢˜</p><div class="appearance-action" data-v-600b50c9><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-600b50c9 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-600b50c9><div class="item social-links" data-v-600b50c9><div class="VPSocialLinks social-links-list" data-v-600b50c9 data-v-a1a7286e><!--[--><a class="VPSocialLink no-icon" href="https://github.com/hyuuko1/blog" aria-label="github" target="_blank" rel="me noopener" data-v-a1a7286e data-v-32d78712><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-8eab0e6d data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-8eab0e6d><div class="divider-line" data-v-8eab0e6d></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-304c8b69 data-v-5ae341c6><div class="container" data-v-5ae341c6><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-5ae341c6><span class="vpi-align-left menu-icon" data-v-5ae341c6></span><span class="menu-text" data-v-5ae341c6>èœå•</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-5ae341c6 data-v-e28a51a6><button data-v-e28a51a6>å›åˆ°é¡¶éƒ¨</button><!----></div></div></div><aside class="VPSidebar" data-v-304c8b69 data-v-46b39de1><div class="curtain" data-v-46b39de1></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-46b39de1><span class="visually-hidden" id="sidebar-aria-label" data-v-46b39de1> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>å‰è¨€</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/update" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>æ›´æ–°è®¡åˆ’</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/gorman_book" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ UTLVMM (Linux 2.6)</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>æè¿°ç‰©ç†å†…å­˜</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/layout" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>å†…å­˜å¸ƒå±€</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/e820" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>e820</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/node" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>node</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/zone" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>zone</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/folio" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>struct page/folio è¯¦è§£</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/vmemmap" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>pfn_to_page() çš„åŸç†ï¼šmem_section ä¸ vmemmap</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>è™šæ‹Ÿå†…å­˜æ˜ å°„</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/rmap" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>rmap åå‘æ˜ å°„</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/vma" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>vma</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/mmap" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>mmap</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/vmap" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>vmap</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/kmap" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>kmap</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/pagefault" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>page fault</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/page_table" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ page table</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/ioremap" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ ioremap</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/fixmap" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ fixmap</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/highmem" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ highmem é«˜ç«¯å†…å­˜</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/cow" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ CoW (Copy on Write)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/uffd" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ UFFD (userfaultfd)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/shmem" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ share memory</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/tlb" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ tlb</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/dma_buf" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ dma-buf</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>å†…å­˜åˆ†é…</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/buddy" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>Buddy System: é¡µé¢åˆ†é…å™¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/vmalloc" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>vmalloc: ä¸è¿ç»­ç‰©ç†å†…å­˜åˆ†é…</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/percpu" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>per-cpu é™æ€å’ŒåŠ¨æ€åˆ†é…</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/oom" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>OOM (Out Of Memory)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/slub" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>SLUB å†…å­˜åˆ†é…å™¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/cma" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>CMA è¿ç»­å†…å­˜åˆ†é…å™¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/memblock" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ æ—©æœŸå†…å­˜åˆ†é…å™¨ memblock</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/gfp" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>GFP (Get Free Page)</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>å¤§é¡µ</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/hugetlb" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>HugeTLB æ ‡å‡†å¤§é¡µ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/thp" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>THP (Transparent Huge Page) é€æ˜å¤§é¡µ</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/mthp" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>mTHP (Multi-size Transparent Huge Page)</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>å†…å­˜å›æ”¶</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/reclaim/reclaim" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>å†…å­˜å›æ”¶(åºŸå¼ƒ)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/reclaim/basic" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>å†…å­˜å›æ”¶åŸºç¡€</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/reclaim/lru" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>LRU</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/reclaim/mglru" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>MGLRU</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/reclaim/workingset" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>workingset</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/reclaim/swap" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>swap</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/mlock" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>mlock</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible has-active" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>å†…å­˜åç¢ç‰‡</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/anti-fragmentation" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ å†…å­˜åç¢ç‰‡</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/compaction" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ å†…å­˜è§„æ•´</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/page_migration" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>é¡µé¢è¿ç§»</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>å…¶ä»–</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/gup" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>GUP (Get User Page)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/pageflags" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>pageflags</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/madvise" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ madvise</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/ksm" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ KSM (Kernel Samepage Merging)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/hotplug" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ hotplug</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/virtio_mem" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ virtio mem</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/virtio_pmem" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ virtio pmem</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/virtio_balloon" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ virtio balloon</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>Non-Uniform Memory Access architecture</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/mm/mempolicy" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ Memory Policy å†…å­˜ç­–ç•¥</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-a84b7c21><section class="VPSidebarItem level-0 collapsible" data-v-a84b7c21 data-v-6b36a2fd><div class="item" role="button" tabindex="0" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><h2 class="text" data-v-6b36a2fd>å†…å­˜ç®¡ç†ä¸æ–‡ä»¶ç³»ç»Ÿ</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-6b36a2fd><span class="vpi-chevron-right caret-icon" data-v-6b36a2fd></span></div></div><div class="items" data-v-6b36a2fd><!--[--><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/storage/readahead" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ readahead é¢„è¯»</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/storage/pagecache" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ page cache</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/storage/page_writeback" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ page writeback</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/storage/tmpfs" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ tmpfs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-6b36a2fd data-v-6b36a2fd><div class="item" data-v-6b36a2fd><div class="indicator" data-v-6b36a2fd></div><a class="VPLink link link" href="/blog/storage/ramfs" data-v-6b36a2fd><!--[--><p class="text" data-v-6b36a2fd>ğŸš§ ramfs</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-304c8b69 data-v-2652e39a><div class="VPDoc has-sidebar has-aside" data-v-2652e39a data-v-d668f7cc><!--[--><!--]--><div class="container" data-v-d668f7cc><div class="aside" data-v-d668f7cc><div class="aside-curtain" data-v-d668f7cc></div><div class="aside-container" data-v-d668f7cc><div class="aside-content" data-v-d668f7cc><div class="VPDocAside" data-v-d668f7cc data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-c8b19031><div class="content" data-v-c8b19031><div class="outline-marker" data-v-c8b19031></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-c8b19031>ç›®å½•</div><ul class="VPDocOutlineItem root" data-v-c8b19031 data-v-63c57e50><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-d668f7cc><div class="content-container" data-v-d668f7cc><!--[--><!--]--><main class="main" data-v-d668f7cc><div style="position:relative;" class="vp-doc _blog_mm_page_migration external-link-icon-enabled" data-v-d668f7cc><div><h1 id="é¡µé¢è¿ç§»-page-migration" tabindex="-1">é¡µé¢è¿ç§»ï¼ˆPage Migrationï¼‰ <a class="header-anchor" href="#é¡µé¢è¿ç§»-page-migration" aria-label="Permalink to â€œé¡µé¢è¿ç§»ï¼ˆPage Migrationï¼‰â€">â€‹</a></h1><p>æ¨èé˜…è¯»ï¼š</p><ul><li><a href="https://lwn.net/Articles/157066/" target="_blank" rel="noreferrer">Page migration [LWN.net]</a></li><li><a href="https://lwn.net/Articles/160201/" target="_blank" rel="noreferrer">VM followup: page migration and fragmentation avoidance [LWN.net]</a></li><li><a href="https://lwn.net/Articles/1015551/" target="_blank" rel="noreferrer">A herd of migration discussions [LWN.net]</a></li><li><a href="https://lore.kernel.org/all/20051101031239.12488.76816.sendpatchset@schroedinger.engr.sgi.com/" target="_blank" rel="noreferrer">[PATCH 0/5] Swap Migration V5: Overview - Christoph Lameter</a></li><li><a href="https://lore.kernel.org/all/20060110224114.19138.10463.sendpatchset@schroedinger.engr.sgi.com/" target="_blank" rel="noreferrer">[PATCH 0/5] Direct Migration V9: Overview - Christoph Lameter</a></li><li><a href="https://cloud.tencent.com/developer/article/1681326" target="_blank" rel="noreferrer">å®‹å®åï¼šè®º Linux çš„é¡µè¿ç§»ï¼ˆPage Migrationï¼‰å®Œæ•´ç‰ˆ</a></li><li><a href="https://www.cnblogs.com/linhaostudy/p/17647370.html" target="_blank" rel="noreferrer">linux é‚£äº›äº‹ä¹‹é¡µè¿ç§»(page migratiom) - yooooooo</a></li><li><a href="https://www.cnblogs.com/tolimit/p/5432674.html" target="_blank" rel="noreferrer">linux å†…å­˜æºç åˆ†æ - å†…å­˜ç¢ç‰‡æ•´ç†(åŒæ­¥å…³ç³») - tolimit - åšå®¢å›­</a></li><li><a href="https://blog.csdn.net/u010923083/article/details/116138670?spm=1001.2014.3001.5501" target="_blank" rel="noreferrer">[å†…æ ¸å†…å­˜] [arm64] å†…å­˜è§„æ•´ 2---é¡µé—´å†…å®¹çš„è¿ç§»ï¼ˆ__unmap_and_move å‡½æ•°)</a></li><li><a href="https://blog.csdn.net/Linux_Everything/article/details/113667395" target="_blank" rel="noreferrer">LWN: è®© ZONE_MOVABLE æ›´åŠ åå‰¯å…¶å®ï¼-CSDN åšå®¢</a></li><li><a href="https://blog.csdn.net/rikeyone/article/details/86498298" target="_blank" rel="noreferrer">å¯¹äº ZONE_MOVABLE çš„ç†è§£_zone movable-CSDN åšå®¢</a></li><li><a href="https://blog.csdn.net/rikeyone/article/details/105863277" target="_blank" rel="noreferrer">å¯¹äº MIGRATE_MOVABLE çš„ç†è§£_movable migrate type-CSDN åšå®¢</a></li><li><a href="https://www.cnblogs.com/aspirs/p/12781693.html" target="_blank" rel="noreferrer">å†…å­˜ç®¡ç†ä¸­å…³äº Movable çš„ç†è§£ - aspirs - åšå®¢å›­</a></li></ul><p>whyï¼Ÿä¾èµ–äºé¡µé¢è¿ç§»çš„æŠ€æœ¯ï¼ˆå…·ä½“å¯ä»¥çœ‹ <code>enum migrate_reason</code>ï¼‰ï¼š</p><ul><li>è¿›ç¨‹è¢«è¿ç§»åˆ°å…¶ä»– NUMA node æ—¶ï¼Œéœ€è¿ç§»é¡µé¢é˜²æ­¢æ€§èƒ½ä¸‹é™ã€‚è¿™æ˜¯é¡µé¢è¿ç§»æœ€åˆè¦è§£å†³çš„é—®é¢˜ã€‚</li><li><a href="./anti-fragmentation">å†…å­˜åç¢ç‰‡</a><ul><li><a href="./compaction">å†…å­˜è§„æ•´</a></li><li><a href="./hotplug">å†…å­˜çƒ­æ’æ‹”</a></li><li><a href="./cma">CMA</a></li></ul></li><li><a href="./cow">CoW</a></li><li><a href="./thp">THP</a></li><li>syscall migrate_pages</li><li>Remapping of bad pages. These could be detected through soft ECC errors and other mechanisms. <a href="https://lwn.net/Articles/156603/" target="_blank" rel="noreferrer">https://lwn.net/Articles/156603/</a></li></ul><p>howï¼Ÿé¡µé¢è¿ç§»ä¾èµ–çš„æŠ€æœ¯ï¼š</p><ul><li><a href="./rmap">åå‘æ˜ å°„</a><ul><li>åŒ¿åé¡µçš„åå‘æ˜ å°„</li><li>æ–‡ä»¶é¡µçš„åå‘æ˜ å°„</li></ul></li><li><a href="./folio">é¡µé¢å¼•ç”¨è®¡æ•°</a></li></ul><p>ä»€ä¹ˆä¼šé˜»æ­¢é¡µé¢äº¤æ¢ï¼Ÿ</p><ul><li>pin ä½çš„é¡µé¢</li><li>ç”¨äº direct I/O çš„é¡µé¢</li><li>æœ‰äººåœ¨ä½¿ç”¨ä¸èƒ½ä¿®æ”¹é¡µè¡¨çš„æ˜ å°„</li></ul><h2 id="patch-swap-migration-v5" tabindex="-1">PATCH: Swap Migration V5 <a class="header-anchor" href="#patch-swap-migration-v5" aria-label="Permalink to â€œPATCH: Swap Migration V5â€">â€‹</a></h2><ul><li><a href="https://lore.kernel.org/all/Pine.LNX.4.62.0510131114140.14810@schroedinger.engr.sgi.com/" target="_blank" rel="noreferrer">[PATCH] Add page migration support via swap to the NUMA policy layer - Christoph Lameter</a></li><li><a href="https://lore.kernel.org/all/20051018004932.3191.30603.sendpatchset@schroedinger.engr.sgi.com/" target="_blank" rel="noreferrer">[PATCH 0/2] Page migration via Swap V2: Overview - Christoph Lameter</a></li><li><a href="https://lore.kernel.org/all/20051020225935.19761.57434.sendpatchset@schroedinger.engr.sgi.com/" target="_blank" rel="noreferrer">[PATCH 0/4] Swap migration V3: Overview - Christoph Lameter</a></li><li><a href="https://lore.kernel.org/all/20051025193023.6828.89649.sendpatchset@schroedinger.engr.sgi.com/" target="_blank" rel="noreferrer">[PATCH 0/5] Swap Migration V4: Overview - Christoph Lameter</a></li><li><a href="https://lore.kernel.org/all/20051101031239.12488.76816.sendpatchset@schroedinger.engr.sgi.com/" target="_blank" rel="noreferrer">[PATCH 0/5] Swap Migration V5: Overview - Christoph Lameter</a></li></ul><div class="language-cpp line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">21eac81f252f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [PATCH] Swap Migration V5: LRU operations</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	æ–°å¢ä¸¤ä¸ªå‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	isolate_lru_page</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() ä» LRU å–å‡ºè¯¥ page å¹¶å°†å…¶æ”¾è¿› indicated list</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	putpack_lru_page</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() å°†é“¾è¡¨ä¸Šçš„ pages æ”¾å› LRU</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">930</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">d915252ed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [PATCH] Swap Migration V5: PF_SWAPWRITE to allow writing to swap</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">49</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">d2e9cc4544</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [PATCH] Swap Migration V5: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">migrate_pages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() function</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">cbe34cf86c6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [PATCH] Swap Migration V5: Add CONFIG_MIGRATION </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page migration support</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dc9aa5b9d65f [PATCH] Swap Migration V5: MPOL_MF_MOVE interface</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">39743889</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">aaf7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [PATCH] Swap Migration V5: sys_migrate_pages interface</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8419</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">c3181086</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [PATCH] SwapMig: CONFIG_MIGRATION fixes</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1480</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">a540c985</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [PATCH] SwapMig: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add_to_swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() avoid atomic allocations</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ee27497df368 [PATCH] SwapMig: Drop unused pages immediately</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d498471133ff [PATCH] SwapMig: Extend parameters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> migrate_pages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d0d963281ccb [PATCH] SwapMig: Switch error handling in migrate_pages to use </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Exx</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>æœ€åˆçš„å®ç°æ–¹æ¡ˆï¼šéå†è¿›ç¨‹çš„å†…å­˜ï¼Œå¹¶å¼ºåˆ¶éœ€è¦è¿ç§»çš„é¡µé¢è¿›è¡Œäº¤æ¢ã€‚å½“è¿›ç¨‹å°†é¡µé¢é‡æ–°åŠ è½½åˆ°å†…å­˜ä¸­æ—¶ï¼Œå®ƒåº”è¯¥åœ¨è¿›ç¨‹çš„å½“å‰èŠ‚ç‚¹ä¸Šåˆ†é…ã€‚</p><h2 id="patch-direct-migration-v9" tabindex="-1">PATCH: Direct Migration V9 <a class="header-anchor" href="#patch-direct-migration-v9" aria-label="Permalink to â€œPATCH: Direct Migration V9â€">â€‹</a></h2><ul><li><a href="https://lore.kernel.org/all/20060110224114.19138.10463.sendpatchset@schroedinger.engr.sgi.com/" target="_blank" rel="noreferrer">[PATCH 0/5] Direct Migration V9: Overview - Christoph Lameter</a></li></ul><div class="language-cpp line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b16664e44c54 [PATCH] Direct Migration V9: PageSwapCache checks</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">a48d07afdf18 [PATCH] Direct Migration V9: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">migrate_pages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() extension</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">a3351e525e47 [PATCH] Direct Migration V9: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">remove_from_swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() to remove swap ptes</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">e</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ab150d1b3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [PATCH] Direct Migration V9: upgrade MPOL_MF_MOVE </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sys_migrate_pages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e965f9630c65 [PATCH] Direct Migration V9: Avoid writeback </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> page_migrate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() method</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="ç³»ç»Ÿè°ƒç”¨" tabindex="-1">ç³»ç»Ÿè°ƒç”¨ <a class="header-anchor" href="#ç³»ç»Ÿè°ƒç”¨" aria-label="Permalink to â€œç³»ç»Ÿè°ƒç”¨â€">â€‹</a></h2><p>migrate_pages</p><p>ä¸æ˜¯å¾ˆå¸¸ç”¨å§</p><p>å°†æŒ‡å®š old_nodes èŠ‚ç‚¹ä¸Šå±äºè¿›ç¨‹ pid çš„æ‰€æœ‰ç‰©ç†é¡µè¿ç§»åˆ° new_nodes èŠ‚ç‚¹ä¸Š</p><div class="language-cpp line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SYSCALL_DEFINE4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(migrate_pages, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pid_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pid, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">unsigned</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> long</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, maxnode,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> unsigned</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> long</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, old_nodes,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> unsigned</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> long</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> __user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, new_nodes)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">unmap_and_move</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">set_mempolicy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MPOL_MF_MOVE</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="zone-movable" tabindex="-1">ZONE_MOVABLE <a class="header-anchor" href="#zone-movable" aria-label="Permalink to â€œZONE_MOVABLEâ€">â€‹</a></h2><ul><li><a href="https://www.cnblogs.com/LoyenWang/p/11568481.html" target="_blank" rel="noreferrer">ã€åŸåˆ›ã€‘ï¼ˆäº”ï¼‰Linux å†…å­˜ç®¡ç† zone_sizes_init - LoyenWang - åšå®¢å›­</a></li><li>ã€ŠLinux å†…æ ¸æ·±åº¦è§£æã€‹3.7.3 æ ¹æ®å¯ç§»åŠ¨æ€§åˆ†ç»„ã€‚</li></ul><div class="language-cpp line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 9 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> pageblock_order</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		MIN_T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">unsigned</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, HUGETLB_PAGE_ORDER, MAX_PAGE_ORDER)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* 512 */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#define</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> pageblock_nr_pages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	(1UL &lt;&lt; pageblock_order)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>åœ¨ç³»ç»Ÿé•¿æ—¶é—´è¿è¡Œåï¼Œç‰©ç†å†…å­˜å¯èƒ½å‡ºç°å¾ˆå¤šç¢ç‰‡ï¼Œå¯ç”¨ç‰©ç†é¡µå¾ˆå¤šï¼Œä½†æ˜¯æœ€å¤§çš„è¿ç»­ç‰©ç†å†…å­˜å¯èƒ½åªæœ‰ä¸€é¡µã€‚å†…å­˜ç¢ç‰‡å¯¹ç”¨æˆ·ç¨‹åºä¸æ˜¯é—®é¢˜ï¼Œå› ä¸ºç”¨æˆ·ç¨‹åºå¯ä»¥é€šè¿‡é¡µè¡¨æŠŠè¿ç»­çš„è™šæ‹Ÿé¡µæ˜ å°„åˆ°ä¸è¿ç»­çš„ç‰©ç†é¡µã€‚ä½†æ˜¯å†…å­˜ç¢ç‰‡å¯¹å†…æ ¸æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºå†…æ ¸ä½¿ç”¨ç›´æ¥æ˜ å°„çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œè¿ç»­çš„è™šæ‹Ÿé¡µå¿…é¡»æ˜ å°„åˆ°è¿ç»­çš„ç‰©ç†é¡µã€‚</p><p>ç®€å•æ¥è¯´ï¼Œå¯è¿ç§»çš„é¡µé¢ä¸ä¸€å®šéƒ½åœ¨ ZONE_MOVABLE ä¸­ï¼Œä½†æ˜¯ ZONE_MOVABLE ä¸­çš„é¡µé¢å¿…é¡»éƒ½æ˜¯å¯è¿ç§»çš„ã€‚</p><ul><li>ç»™ç”¨æˆ·åˆ†é…çš„åŒ¿åé¡µï¼Œä½¿ç”¨çš„æ˜¯ <code>GFP_HIGHUSER_MOVABLE</code> åŒ…å«äº† <code>__GFP_HIGHMEM | __GFP_MOVABLE</code>ï¼Œæ„å‘³ç€å¯ä»¥ä» ZONE_MOVABLE åˆ†é…ã€‚</li><li>åˆ†é…ç»™å†…æ ¸ä½¿ç”¨çš„å†…å­˜ï¼Œéƒ½æ˜¯ä¸å¯ç§»åŠ¨çš„ï¼ˆå› ä¸ºå­˜åœ¨çº¿æ€§æ˜ å°„ï¼Œè¿™ä¸ªæ˜ å°„ä¸èƒ½ä¿®æ”¹ï¼‰ï¼Œæ‰€ä»¥ä¸èƒ½ä» ZONE_MOVABLE åˆ†é…ã€‚ <ul><li>XXX vmalloc åˆ†é…çš„å†…å­˜ï¼Œä¸æ˜¯çº¿æ€§æ˜ å°„çš„ï¼Œåº”è¯¥å¯ä»¥ç§»åŠ¨ï¼Ÿä¸ºä»€ä¹ˆä¸ä» ZONE_MOVABLE åˆ†é…å‘¢ï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨ GFP_KERNEL å‘¢ï¼Ÿ</li><li>åˆ†é…å¤§é¡µæ—¶ï¼ŒZONE_MOVABLE çš„å†…å­˜å› ä¸ºå¯ä»¥ç›´æ¥è¿ç§»ï¼Œæ‰€ä»¥ä» ZONE_MOVABLE åˆ†é…å¤§é¡µåº”è¯¥æ¯”è¾ƒå®¹æ˜“ï¼Ÿ</li></ul></li></ul><h2 id="migratetype" tabindex="-1">migratetype <a class="header-anchor" href="#migratetype" aria-label="Permalink to â€œmigratetypeâ€">â€‹</a></h2><p>ä¸ºäº†é¢„é˜²å†…å­˜ç¢ç‰‡ï¼Œå†…æ ¸æ ¹æ®å¯ç§»åŠ¨æ€§æŠŠç‰©ç†é¡µåˆ†ä¸º 3 ç§ç±»å‹ï¼ˆä½“ç°åœ¨ï¼š3 ç§ç±»å‹çš„ä½äºä¸åŒçš„ pcp list é‡Œï¼‰ã€‚</p><ol><li>ä¸å¯ç§»åŠ¨é¡µï¼šä½ç½®å¿…é¡»å›ºå®šï¼Œä¸èƒ½ç§»åŠ¨ï¼Œç›´æ¥æ˜ å°„åˆ°å†…æ ¸è™šæ‹Ÿåœ°å€ç©ºé—´çš„é¡µï¼Œæ¯”å¦‚ kmalloc ç”³è¯·çš„é¡µé¢ï¼Œå±äºè¿™ä¸€ç±»ã€‚</li><li>å¯ç§»åŠ¨é¡µï¼šä½¿ç”¨é¡µè¡¨æ˜ å°„çš„é¡µå±äºè¿™ä¸€ç±»ï¼Œå¯ä»¥ç§»åŠ¨åˆ°å…¶ä»–ä½ç½®ï¼Œç„¶åä¿®æ”¹é¡µè¡¨æ˜ å°„ã€‚</li><li>å¯å›æ”¶é¡µï¼šä¸èƒ½ç§»åŠ¨ï¼Œä½†å¯ä»¥å›æ”¶ï¼Œéœ€è¦æ•°æ®çš„æ—¶å€™å¯ä»¥é‡æ–°ä»æ•°æ®æºè·å–ã€‚åå¤‡å­˜å‚¨è®¾å¤‡æ”¯æŒçš„é¡µå±äºè¿™ä¸€ç±»ã€‚</li></ol><p>å†…æ ¸æŠŠå…·æœ‰ç›¸åŒå¯ç§»åŠ¨æ€§çš„é¡µåˆ†ç»„ã€‚ä¸ºä»€ä¹ˆè¿™ç§æ–¹æ³•å¯ä»¥å‡å°‘ç¢ç‰‡ï¼Ÿè¯•æƒ³ï¼šå¦‚æœä¸å¯ç§»åŠ¨é¡µå‡ºç°åœ¨å¯ç§»åŠ¨å†…å­˜åŒºåŸŸçš„ä¸­é—´ï¼Œä¼šé˜»æ­¢å¯ç§»åŠ¨å†…å­˜åŒºåŸŸåˆå¹¶ã€‚è¿™ç§æ–¹æ³•æŠŠä¸å¯ç§»åŠ¨é¡µèšé›†åœ¨ä¸€èµ·ï¼Œå¯ä»¥é˜²æ­¢ä¸å¯ç§»åŠ¨é¡µå‡ºç°åœ¨å¯ç§»åŠ¨å†…å­˜åŒºåŸŸçš„ä¸­é—´ã€‚</p><div class="language-cpp line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* è¿ç§»ç±»å‹ */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">enum</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> migratetype</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	/* ä¸å¯ç§»åŠ¨é¡µï¼Œä¸»è¦æ˜¯å†…æ ¸åˆ†é…çš„é¡µï¼ˆlinuxå†…æ ¸åˆ†é…é¡µå¾ˆå¤šæ˜¯çº¿æ€§æ˜ å°„çš„é¡µï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	è¿™äº›é¡µçš„è™šæ‹Ÿåœ°å€å’Œç‰©ç†åœ°å€æ˜¯é€šè¿‡å›ºå®šçš„åç§»è¿›è¡Œæ˜ å°„çš„ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	å› æ­¤ä¸èƒ½å°†ç‰©ç†é¡µçš„å†…å®¹ç§»åŠ¨åˆ°å…¶ä»–ç©ºé—²ç‰©ç†é¡µä¸­ï¼‰ */</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	MIGRATE_UNMOVABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	/* å¯ç§»åŠ¨é¡µï¼Œèƒ½å°†é¡µä¸­çš„å†…å®¹è¿ç§»åˆ°å…¶ä»–ç‰©ç†é¡µä¸­ï¼Œä¸»è¦æ˜¯ä¸€äº›ç”¨æˆ·ç©ºé—´åˆ†é…çš„é¡µ */</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	MIGRATE_MOVABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	/* å¯å›æ”¶é¡µï¼Œä¸èƒ½è¿ç§»ï¼Œä½†èƒ½è¿›è¡Œå›æ”¶å¤„ç† */</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	MIGRATE_RECLAIMABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	MIGRATE_PCPTYPES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	/* the number of types on the pcp lists */</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	MIGRATE_HIGHATOMIC</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MIGRATE_PCPTYPES,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#ifdef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CONFIG_CMA</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	/* MIGRATE_CMA è¢«è®¾è®¡æˆæ¨¡æ‹Ÿ ZONE_MOVABLE å·¥ä½œçš„æ–¹å¼ï¼Œ */</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	/*</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	 * MIGRATE_CMA migration type is designed to mimic the way</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	 * ZONE_MOVABLE works.  Only movable pages can be allocated</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	 * from MIGRATE_CMA pageblocks and page allocator never</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	 * implicitly change migration type of MIGRATE_CMA pageblock.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	 *</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	 * The way to use it is to change migratetype of a range of</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	 * pageblocks to MIGRATE_CMA which can be done by</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	 * __free_pageblock_cma() function.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	 */</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	MIGRATE_CMA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#endif</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#ifdef</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CONFIG_MEMORY_ISOLATION</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	MIGRATE_ISOLATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	/* can&#39;t allocate from here */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#endif</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	MIGRATE_TYPES</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>MIGRATE_RECLAIMABLE ä¸å¯ä»¥è¿ç§»ï¼Œä½†æ˜¯å¯ä»¥å›æ”¶ï¼Œä¸»è¦æ˜¯ SLABï¼Œè€Œé page cacheã€‚ ä» inode_init_always_gfp()-&gt;mapping_set_gfp_mask(mapping, GFP_HIGHUSER_MOVABLE) å…‹åˆ¶ page cache æ˜¯ MIGRATE_MOVABLEï¼Œè€Œä¸æ˜¯ MIGRATE_RECLAIMABLEï¼Œå¾ˆå¤šåšå®¢æ–‡ç« éƒ½å†™é”™äº†ã€‚</p><p>å‰é¢ 3 ç§æ˜¯çœŸæ­£çš„è¿ç§»ç±»å‹ï¼Œåé¢çš„è¿ç§»ç±»å‹éƒ½æœ‰ç‰¹æ®Šç”¨é€”ï¼š MIGRATE_HIGHATOMIC ç”¨äºé«˜é˜¶åŸå­åˆ†é…ï¼ŒMIGRATE_CMA ç”¨äºè¿ç»­å†…å­˜åˆ†é…å™¨ï¼ŒMIGRATE_ISOLATE ç”¨æ¥éš”ç¦»ç‰©ç†é¡µï¼ˆç”±è¿ç»­å†…å­˜åˆ†é…å™¨ã€å†…å­˜çƒ­æ’æ‹”å’Œä»å†…å­˜ç¡¬ä»¶é”™è¯¯æ¢å¤ç­‰åŠŸèƒ½ä½¿ç”¨ï¼‰ã€‚</p><p>pageblock_order æ˜¯æŒ‰å¯ç§»åŠ¨æ€§åˆ†ç»„çš„é˜¶æ•°ï¼Œç®€ç§°åˆ†ç»„é˜¶æ•°ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ç§è¿ç§»ç±»å‹çš„ä¸€ä¸ªé¡µå—çš„æœ€å°é•¿åº¦ã€‚å¦‚æœå†…æ ¸æ”¯æŒå·¨å‹é¡µï¼Œé‚£ä¹ˆ pageblock_order æ˜¯å·¨å‹é¡µçš„é˜¶æ•°ï¼Œå¦åˆ™ pageblock_order æ˜¯ä¼™ä¼´åˆ†é…å™¨çš„æœ€å¤§åˆ†é…é˜¶ã€‚</p><p>åŒä¸€ä¸ª pageblock å†…çš„é¡µé¢ï¼Œè¿ç§»ç±»å‹æ˜¯ç›¸åŒçš„ã€‚</p><p>TODO ç–‘é—®ï¼šä¸ºå•¥ä¼šæœ‰ pageblock è¿™ç§ä¸œè¥¿ã€‚æœ‰äº† pageblock åï¼Œå°±æœ‰å¾ˆå¤šè¿ç»­ 2M çš„ç›¸åŒçš„è¿ç§»ç±»å‹çš„é¡µé¢ï¼Œæ„Ÿè§‰ç¡®å®æœ‰åˆ©äºåšé¡µé¢è¿ç§»å¾—åˆ°æ›´å¤šè¿ç»­é¡µã€‚</p><p>ç”³è¯·æŸç§è¿ç§»ç±»å‹çš„é¡µæ—¶ï¼Œå¦‚æœè¿™ç§è¿ç§»ç±»å‹çš„é¡µç”¨å®Œäº†ï¼Œå¯ä»¥ä»å…¶ä»–è¿ç§»ç±»å‹ç›—ç”¨ï¼ˆstealï¼‰ç‰©ç†é¡µã€‚ å¦‚æœéœ€è¦ä»å¤‡ç”¨ç±»å‹ç›—ç”¨ç‰©ç†é¡µï¼Œé‚£ä¹ˆä»æœ€å¤§çš„é¡µå—å¼€å§‹ç›—ç”¨ï¼Œä»¥é¿å…äº§ç”Ÿç¢ç‰‡ã€‚ å†…æ ¸å®šä¹‰äº†æ¯ç§è¿ç§»ç±»å‹çš„å¤‡ç”¨ç±»å‹ä¼˜å…ˆçº§åˆ—è¡¨ï¼š</p><div class="language-cpp line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fallbacks[MIGRATE_PCPTYPES][MIGRATE_PCPTYPES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	[MIGRATE_UNMOVABLE]   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { MIGRATE_RECLAIMABLE, MIGRATE_MOVABLE   },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	[MIGRATE_MOVABLE]     </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { MIGRATE_RECLAIMABLE, MIGRATE_UNMOVABLE },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	[MIGRATE_RECLAIMABLE] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { MIGRATE_UNMOVABLE,   MIGRATE_MOVABLE   },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>å‡½æ•° <code>set_pageblock_migratetype()</code> ç”¨æ¥åœ¨é¡µå—æ ‡å¿—ä½å›¾ä¸­è®¾ç½®é¡µå—çš„è¿ç§»ç±»å‹ï¼Œå‡½æ•° <code>get_pageblock_migratetype()</code> ç”¨æ¥è·å–é¡µå—çš„è¿ç§»ç±»å‹ã€‚</p><p><strong>å†…æ ¸åœ¨åˆå§‹åŒ–æ—¶ï¼ŒæŠŠæ‰€æœ‰é¡µå—åˆå§‹åŒ–ä¸ºå¯ç§»åŠ¨ç±»å‹ï¼Œå…¶ä»–è¿ç§»ç±»å‹çš„é¡µæ˜¯ç›—ç”¨äº§ç”Ÿçš„ã€‚</strong></p><div class="language-cpp line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">memmap_init_zone_range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  memmap_init_range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(, MIGRATE_MOVABLE)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># æŸ¥çœ‹å„ç§è¿ç§»ç±»å‹çš„é¡µçš„åˆ†å¸ƒæƒ…å†µ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;user-select:none;-webkit-user-select:none;">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /proc/pagetypeinfo</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div></div></main><footer class="VPDocFooter" data-v-d668f7cc data-v-1bcd8184><!--[--><!--]--><div class="edit-info" data-v-1bcd8184><div class="edit-link" data-v-1bcd8184><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/hyuuko1/blog/edit/main/mm/page_migration.md" target="_blank" rel="noreferrer" data-v-1bcd8184><!--[--><span class="vpi-square-pen edit-link-icon" data-v-1bcd8184></span> Edit this page<!--]--></a></div><div class="last-updated" data-v-1bcd8184><p class="VPLastUpdated" data-v-1bcd8184 data-v-73dafb42>æœ€åæ›´æ–°äº: <time datetime="2025-11-23T15:44:07.000Z" data-v-73dafb42></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link prev" href="/blog/mm/compaction" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>ä¸Šä¸€é¡µ</span><span class="title" data-v-1bcd8184>ğŸš§ å†…å­˜è§„æ•´</span><!--]--></a></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/blog/mm/gup" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>ä¸‹ä¸€é¡µ</span><span class="title" data-v-1bcd8184>GUP (Get User Page)</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-304c8b69 data-v-5b9946f5><div class="container" data-v-5b9946f5><p class="message" data-v-5b9946f5>Licensed under MIT</p><p class="copyright" data-v-5b9946f5>Copyright Â© 2024-2025 HYUUKO</p></div></footer><!--[--><!--]--></div></div>
    
    
  </body>
</html>