import{_ as a,c as i,o as n,al as p}from"./chunks/framework.CdzZEkix.js";const c=JSON.parse('{"title":"e820","description":"","frontmatter":{"head":[["meta",{"property":"og:title","content":"e820 | Blog"}]]},"headers":[],"relativePath":"mm/e820.md","filePath":"mm/e820.md","lastUpdated":1763912647000}'),e={name:"mm/e820.md"};function l(h,s,k,t,r,E){return n(),i("div",null,[...s[0]||(s[0]=[p(`<h1 id="e820" tabindex="-1">e820 <a class="header-anchor" href="#e820" aria-label="Permalink to â€œe820â€">â€‹</a></h1><ul><li><a href="https://richardweiyang-2.gitbook.io/kernel-exploring/nei-cun-guan-li/00-memory_a_bottom_up_view/01-e820_retrieve_memory_from_hw" target="_blank" rel="noreferrer">e820 ä»ç¡¬ä»¶è·å–å†…å­˜åˆ†å¸ƒ | Kernel Exploring</a></li><li>ğŸŒŸ <a href="http://www.biscuitos.cn/blog/MMU-E820/" target="_blank" rel="noreferrer">E820 å†…å­˜ç®¡ç†å™¨</a></li><li><a href="http://www.biscuitos.cn/blog/MMU-seaBIOS_E820/" target="_blank" rel="noreferrer">E820 on seaBIOS</a></li><li><a href="http://www.biscuitos.cn/blog/MMU-QEMU-KVM_E820/" target="_blank" rel="noreferrer">E820 on Qemu/KVM</a></li><li><a href="https://wiki.osdev.org/Detecting_Memory_(x86)" target="_blank" rel="noreferrer">Detecting Memory (x86) - OSDev Wiki</a></li><li>ğŸŒŸã€ŠQEMU/KVM æºç è§£æä¸åº”ç”¨ã€‹ <ul><li>3.2 fw_cfg è®¾å¤‡ä»‹ç»</li><li>3.4 SeaBIOS åˆ†æ</li></ul></li></ul><h2 id="qemu-fw-cfg" tabindex="-1">QEMU fw_cfg <a class="header-anchor" href="#qemu-fw-cfg" aria-label="Permalink to â€œQEMU fw_cfgâ€">â€‹</a></h2><p><a href="/blog/bios/seabios#qemu-fw-cfg">sebios.md</a></p><p>QEMU/KVM ä½œä¸ºè™šæ‹ŸåŒ–æ ¸å¿ƒç»„å»ºï¼Œå…¶å¯ä»¥ç”¨äºæ¨¡æ‹Ÿ X86 è¿è¡Œç¯å¢ƒï¼Œå› æ­¤å…¶å…·å¤‡æ„å»º X86 å¹³å°ç¡¬ä»¶ä¿¡æ¯çš„èƒ½åŠ›ï¼ŒQEMU/KVM åŒæ ·æä¾›äº†åˆ›å»º E820 çš„æœºåˆ¶ï¼Œç”¨äºä¸º seaBIOS æ¨¡æ‹Ÿ E820 ç›¸å…³çš„ç¡¬ä»¶ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…æ‹¬äº† BIOS çš„ CMOS å†…å­˜ï¼Œhw_cfg å›ºä»¶ä¿¡æ¯ç­‰ã€‚</p><h2 id="seabios" tabindex="-1">seabios <a class="header-anchor" href="#seabios" aria-label="Permalink to â€œseabiosâ€">â€‹</a></h2><p><a href="/blog/bios/seabios">sebios.md</a></p><p>BIOS POST (Power On Self Test) ä¸Šç‚¹è‡ªæ£€ä¹‹åï¼Œä¼šä» CMOS ä¸­è·å¾—å†…å­˜ç›¸å…³çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯ç”¨äºæ„å»º BIOS çš„ BDA/EBDA ä¿¡æ¯ï¼Œä»¥ä¾¿ BIOS æ„å»ºè‡ªå·±çš„ E820 è¡¨ï¼ŒBIOS æ„å»ºçš„ E820 è¡¨æ„å»ºå®Œæ¯•ä¹‹åä¼šå°† E820 è¡¨é‡Œçš„å†…å­˜åŒºåŸŸä¸ BIOS IVT çš„ 0x15/E820 ä¸­æ–­ä¾‹ç¨‹è¿›è¡Œç»‘å®šï¼Œå½“å†…æ ¸åˆå§‹åŒ–æ—¶é€šè¿‡ä¸ BIOS IVT è¿›è¡Œäº¤äº’ï¼ŒBIOS å°† E820 è¡¨ä¼ é€’ç»™äº†å†…æ ¸ã€‚BIOS åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ä¹Ÿä¼šé¢„ç•™ä¸€äº›å†…å­˜åŒºåŸŸï¼Œè¿™äº›å†…å­˜åŒºåŸŸä¹Ÿä¼šä¸€åŒä¼ é€’ç»™å†…æ ¸ã€‚</p><div class="language-cpp line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">reset_vector-&gt;entry_post-&gt;dopost-&gt;maininit-&gt;interface_init</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  qemu_cfg_init</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    qemu_cfg_e820</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      /* é€šè¿‡ qemu çš„ fw_cfg æ¥å£ï¼Œè·å– e820 table  */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      qemu_cfg_read_entry</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      e820_add</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>seabios åœ¨ IVT é‡Œæä¾›äº†å¾ˆå¤šä¸­æ–­å…¥å£ã€‚</p><p>åœ¨ X86 æ¶æ„ Linux å†…æ ¸å‘å±•çš„è¿‡ç¨‹ä¸­ï¼Œç‰©ç†å†…å­˜æ”¯æŒçš„é•¿åº¦ä» 16MB å‘å±•åˆ° 64MBã€4GB å†åˆ°ä»Šå¤©æ”¯æŒ 64-bit çš„åœ°å€æ€»çº¿ï¼ŒBIOS åœ¨ä¸åŒçš„å†å²é˜¶æ®µæä¾›äº†ä¸åŒçš„ä¸­æ–­è°ƒç”¨ï¼Œ ä»¥æ»¡è¶³å†…æ ¸ä» BIOS ä¸­è·å¾—å†…å­˜åŒºåŸŸç›¸å…³çš„ä¿¡æ¯ã€‚ linux å‘èµ· int 0x15 ä¸­æ–­ï¼Œé€šè¿‡ BIOS ä¸­æ–­ä¾‹ç¨‹æ¢æµ‹ç‰©ç†å†…å­˜</p><div class="language-cpp line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">handle_15</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">handle_15e8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">handle_15e820</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="è¿›å…¥-vmlinux-å‰-å®æ¨¡å¼" tabindex="-1">è¿›å…¥ vmlinux å‰ï¼ˆå®æ¨¡å¼ï¼‰ <a class="header-anchor" href="#è¿›å…¥-vmlinux-å‰-å®æ¨¡å¼" aria-label="Permalink to â€œè¿›å…¥ vmlinux å‰ï¼ˆå®æ¨¡å¼ï¼‰â€">â€‹</a></h2><p>linux kernel åœ¨å®æ¨¡å¼è¿›è¡Œæœ€æ—©æœŸçš„åˆå§‹åŒ–ï¼Œé€šè¿‡ BIOS æä¾›çš„ IVT è¡¨åˆ†åˆ«ä» 0x15/0xE820ã€0x15/0xE801 ä»¥åŠ 0x15/0x88 ä¸­è·å¾—ç‰©ç†å†…å­˜ä¿¡æ¯ï¼Œå¹¶å°†ä¿¡æ¯å­˜å‚¨åœ¨ boot_params æ•°æ®ç»“æ„é‡Œé¢ã€‚ä¹‹åè¿›å…¥ä¿æŠ¤æ¨¡å¼ã€‚</p><div class="language-cpp line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* arch/x86/boot/main.c è¢«ç¼–è¯‘è¿› setup.elf äº†</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   æ­¤æ—¶åœ¨å®æ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">*/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">main</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  detect_memory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    detect_memory_e820</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      /* é€šè¿‡ BIOS INT 0x15/E820 è°ƒç”¨è·å¾—ç³»ç»Ÿå†…å­˜å¸ƒå±€ä¿¡æ¯ */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ireg.ax  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> 0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">e820</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      intcall</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ireg, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">oreg);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      boot_params.e820_entries </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> count;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    detect_memory_e801</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    detect_memory_88</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>æœ‰ä¸¤ä¸ªåœ°æ–¹å®šä¹‰äº† boot_params å˜é‡ï¼Œåˆ†åˆ«æ˜¯ setup.bin å’Œ vmlinux.bin é‡Œï¼ˆè¿™ä¸¤ä¸ªä¼šå¹¶æˆ bzImageï¼‰ã€‚ æ˜¯ setup.bin é‡Œçš„ boot_params å…ˆåˆå§‹åŒ–ï¼Œç„¶åä¼šæŠŠ boot_params ä¼ ç»™ vmlinuxï¼š</p><div class="language-cpp line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* setup.bin é‡Œ */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">go_to_protected_mode</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /* æŠŠ arch/x86/boot/main.c é‡Œçš„ boot_params çš„åœ°å€ä¼ è¿‡å»äº†ï¼ˆç¬¬äºŒä¸ªå‚æ•°ï¼‰ */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  protected_mode_jump</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* ç„¶åè¿›å…¥ä¿æŠ¤æ¨¡å¼è·³è½¬åˆ° setup.bin çš„ startup_64 !</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    https://docs.hust.openatom.club/linux-insides-zh/booting/linux-bootstrap-4 */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">startup_64</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /* æŠŠ arch/x86/boot/main.c é‡Œçš„ boot_params çš„åœ°å€ä¼ åˆ°äº†è¿™ä¸ªå‡½æ•° */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  __startup_64</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  common_startup_64</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    early_setup_idt</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    initial_code ä¹Ÿå³ x86_64_start_kernel</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      copy_bootdata</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        /* æŠŠ arch/x86/boot/main.c é‡Œçš„ boot_params æ‹·è´åˆ° arch/x86/kernel/setup.c</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           é‡Œçš„ boot_params */</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        /* å¦‚æœæ˜¯ CONFIG_PVHï¼Œåˆ™æ˜¯æ‹·è´äº† pvh_bootparams  */</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        memcpy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">boot_params, real_mode_data, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">sizeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(boot_params));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      x86_64_start_reservations-&gt;start_kernel</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>å¦‚æœä¸ç”¨ bzImage å¯åŠ¨ï¼ˆCONFIG_PVHï¼‰ï¼Œè€Œæ˜¯ç›´æ¥ç”¨ vmlinux å¯åŠ¨ï¼Œé‚£åˆ™æ˜¯åœ¨ init_pvh_bootparams é‡Œåˆå§‹åŒ–çš„ï¼Ÿ</p><h2 id="è¿›å…¥-vmlinux-å-ä¿æŠ¤æ¨¡å¼" tabindex="-1">è¿›å…¥ vmlinux åï¼ˆä¿æŠ¤æ¨¡å¼ï¼‰ <a class="header-anchor" href="#è¿›å…¥-vmlinux-å-ä¿æŠ¤æ¨¡å¼" aria-label="Permalink to â€œè¿›å…¥ vmlinux åï¼ˆä¿æŠ¤æ¨¡å¼ï¼‰â€">â€‹</a></h2><p>å†…æ ¸åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œå®æ—¶æ¨¡å¼ä¸­ä» BIOS ä¸­è·å¾—å¹¶æ„å»º E820 è¡¨ï¼Œç„¶åç»“åˆ CMDLINE å‚æ•°å’Œ boot_paras å‚æ•°æ„å»ºå†…æ ¸è‡ªèº«çš„ E820 è¡¨ï¼Œå¹¶åŸºäºè¯¥è¡¨æ„å»ºç³»ç»Ÿçš„ IORESOURCE ä¿¡æ¯å’Œå›ºä»¶ä¿¡æ¯ï¼Œæœ€ååŸºäº E820 è¡¨ä¸­å¯ç”¨å†…å­˜åŒºåŸŸä¿¡æ¯æ„å»º BootMEM æˆ–è€… MEMBLOCK å†…å­˜åˆ†é…å™¨ã€‚</p><p>æ„å»º e820_tableã€e820_table_kexec å’Œ e820_table_firmware ä¸‰ä¸ªè¡¨ï¼Œå¹¶å°† e820_table æŒ‰ä¸€å®šçš„é¡ºåºè¿›è¡Œæ’åºã€‚å¤„ç†å®Œè¡¨ä¹‹åï¼Œ å†…æ ¸è®¡ç®—å‡º max_pfn/max_low_pfn/high_memory ä¸‰ä¸ªå˜é‡çš„å€¼ï¼Œæ¥ç€å†…æ ¸å°† e820_table çš„å¯ç”¨å†…å­˜åŒºåŸŸæ·»åŠ åˆ° MEMBLOCK åˆ†é…å™¨ï¼ŒMEMBLOCK åˆ†é…å™¨ä»¥è¿™äº›ä¿¡æ¯ä¸ºåŸºç¡€æ„å»ºå†…æ ¸ ç¬¬ä¸€ä¸ªå†…å­˜åˆ†é…å™¨ã€‚å†…æ ¸æ¥ç€å°† e820_table ä¸­çš„é¢„ç•™åŒºåŸŸæ’å…¥åˆ° iomem_resource è¿›è¡Œ ç®¡ç†ï¼Œå¹¶å°† e820_table_firmware åŠ å…¥ç³»ç»Ÿå›ºä»¶å±‚è¿›è¡Œç®¡ç†ã€‚</p><p>å†…æ ¸æ ¹æ®è¿™äº›ä¿¡æ¯ï¼Œä¸ºä¹‹åçš„ MEMBLOCK å†…å­˜ç®¡ç†å™¨çš„åˆå§‹åŒ–æä¾›äº†åŸºç¡€ã€‚</p><p>æ³¨æ„ï¼Œæ­¤æ—¶å†…æ ¸ç”¨çš„ boot_params æ˜¯ arch/x86/kernel/setup.c é‡Œå®šä¹‰çš„ï¼Œè€Œé arch/x86/boot/main.c é‡Œå®šä¹‰çš„é‚£ä¸ª</p><div class="language-cpp line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">start_kernel-&gt;setup_arch</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  e820__memory_setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* æ ¹æ® boot_params è®°å½•çš„ e820 ä¿¡æ¯ï¼Œæ„å»º e820_table å¹¶æ’åº */</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    e820__memory_setup_default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* å†æ‹·è´æˆä¸¤ä¸ªæ–°çš„è¡¨ e820_table_kexec å’Œ e820_table_firmware */</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    memcpy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e820_table_kexec, e820_table, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">sizeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e820_table_kexec));</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    memcpy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e820_table_firmware, e820_table, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">sizeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e820_table_firmware));</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* æ­¤æ—¶æ‰“å°çš„æ˜¯åŸå§‹ BIOS E820 ä¿¡æ¯ */</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    e820__print_table</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /* boot_params.e820_table åªèƒ½å®¹çº³ 128 ä¸ªï¼Œå¤šäºçš„é€šè¿‡ boot_params.hdr.setup_data ä¼ é€’ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     ä¼šæ›´æ–° e820_table */</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  parse_setup_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    e820__memory_setup_extended</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /* è§£æç”¨ early_param å®šä¹‰è¿‡çš„å‚æ•°ï¼Œæ¯”å¦‚ mem= å’Œ memmap= å¯¹ e820_table åšä¸€äº›è°ƒæ•´ */</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  parse_early_param</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* å°† e820_table å¤§äº mem=size çš„åŒºåŸŸç§»é™¤ */</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    parse_memopt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      e820__range_remove</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mem_size, ULLONG_MAX </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mem_size, E820_TYPE_RAM, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* æ·»åŠ æˆ–ä¿®æ”¹ e820_table å†…å­˜åŒºåŸŸä¿¡æ¯ */</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    parse_memmap_opt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /* å°† boot_params.hdr.setup_data å†…å­˜åŒºåŸŸè¿›è¡Œä¿ç•™ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬åé¢å¯èƒ½è¿˜ä¼šç”¨åˆ°è¿™äº› setup_data</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     æ¯”å¦‚ pci_device_add-&gt;pcibios_device_add */</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  e820__reserve_setup_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /* æ›´æ–° mem= è°ƒæ•´è¿‡åçš„ e820_table */</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  e820__finish_early_params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /* ç”±äº BIOS å¤æ‚æ€§æˆ–æ˜¯ CMDLINE ä¸­åŒ…å«äº† â€œmemmap=exactmapâ€ æˆ– â€œmemmap=xxM$yyMâ€</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     å¯¼è‡´å†…æ ¸æœ¬èº«å ç”¨çš„å†…å­˜åŒºåŸŸä¸æ˜¯ E820_TYPE_RAMï¼Œå°±éœ€è¦å°†å†…æ ¸æœ¬èº«å ç”¨çš„åŒºåŸŸæ ‡è®°ä¸º E820_TYPE_RAM */</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  e820_add_kernel_range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /* max_pfn æ˜¯æœ€å¤§ç‰©ç†é¡µå¸§å·ï¼Œmax_low_pfn æ˜¯ 4GB å†…æœ€å¤§çš„ç‰©ç†é¡µå¸§å· */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /* åŸºäº e820_table çš„ E820_TYPE_RAM ç±»å‹çš„åŒºåŸŸï¼Œæ„å»º memblock å†…å­˜åˆ†é…å™¨ */</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  e820__memblock_setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> memblock_add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(entry-&gt;addr, entry-&gt;size);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /* ä» memblock åˆ†é…å™¨ä¸­ä¸º mptable åˆ†é… 4KB ç‰©ç†å†…å­˜ï¼Œå¹¶åœ¨ e820_table_kexec ä¸­åšé¢„ç•™ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     ç›¸å…³ cmdline æœ‰ alloc_mptable update_mptable */</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  e820__memblock_alloc_reserved_mpc_new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /* å°† e820_table ä¸­é¢„ç•™åŒºåŸŸå†…å­˜æ’å…¥åˆ° iomem_resource èµ„æºæ ‘ä¸‹ï¼Œä»¥ä¾¿ç»´æŠ¤ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     è¿˜åœ¨ /sys/firmware/memmap é‡ŒåŠ äº†äº› */</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  e820__reserve_resources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* E820_TYPE_RESERVED_KERN å’Œ E820_TYPE_RAM å±äº System RAMï¼Œå…¶ä»–éƒ½æ˜¯ IO å†…å­˜ */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    res-&gt;flags </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> e820_type_to_iomem_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(entry);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* TODO IORESOURCE_BUSY æ˜¯æŒ‡ä»€ä¹ˆï¼Ÿæ˜¯æŒ‡è¿™ä¸ªèµ„æºå·²è¢«å ç”¨ï¼Œé©±åŠ¨ä¸èƒ½ä½¿ç”¨è¿™ä¸ªèµ„æºï¼Ÿ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       æ¯”å¦‚ï¼Œè¦ä¸º BAR ç©ºé—´åˆ†é…ä¸€æ®µåœ°å€åŒºåŸŸï¼Œé‚£å°±ä¸èƒ½ç”³è¯· IORESOURCE_BUSY çš„ï¼Ÿ*/</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> do_mark_busy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      res-&gt;flags </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IORESOURCE_BUSY;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      insert_resource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">iomem_resource, res);</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> /* æ’å…¥åˆ° iomem_resource ç®¡ç† */</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    firmware_map_add_early</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> /* /sys/firmware/memmap */</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* kernel_init çº¿ç¨‹ */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kernel_init</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  free_initmem</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* æ¸…é™¤ initdata ä¹‹å‰ï¼Œé‡æ–°ä¸º e820_table åˆ†é…å†…å­˜ */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    e820__reallocate_tables</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      n </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> kmemdup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e820_table, size, GFP_KERNEL);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      e820_table </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><p>TODO e820_table_kexec å’Œ e820_table_firmware</p><h2 id="sys-firmware-memmap" tabindex="-1">/sys/firmware/memmap <a class="header-anchor" href="#sys-firmware-memmap" aria-label="Permalink to â€œ/sys/firmware/memmapâ€">â€‹</a></h2><p>drivers/firmware/memmap.c</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # ls /sys/firmware/memmap/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  6</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  7</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  8</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # cat /sys/firmware/memmap/0/start</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0x0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # cat /sys/firmware/memmap/0/end</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0x9fbff</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # cat /sys/firmware/memmap/0/type</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">System</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RAM</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="struct-biosregs" tabindex="-1"><code>struct biosregs</code> <a class="header-anchor" href="#struct-biosregs" aria-label="Permalink to â€œstruct biosregsâ€">â€‹</a></h2><p>struct biosregs æ•°æ®ç»“æ„ç”¨äºç»´æŠ¤ä¸€å¥—å¯„å­˜å™¨ç»„ï¼Œä»¥ä¾¿ç”¨äº BIOS è°ƒç”¨æ—¶å€™äº¤æ¢å¯„å­˜å™¨ã€‚ struct biosregs æ•°æ®ç»“æ„å†…éƒ¨ä½¿ç”¨ä¸€ä¸ª union è”åˆä½“åŒ…å«äº†ä¸‰å¥—å¯„å­˜å™¨ã€‚åˆ†åˆ«å¯¹åº”ä¿æŠ¤æ¨¡å¼ã€å®æ¨¡å¼ã€å…¼å®¹ 8086 æ¨¡å¼ã€‚</p><h2 id="cmdline-mem-memmap" tabindex="-1">cmdline <code>mem=</code> <code>memmap=</code> <a class="header-anchor" href="#cmdline-mem-memmap" aria-label="Permalink to â€œcmdline mem= memmap=â€">â€‹</a></h2><p>åœ¨åˆå§‹åŒ–æ¥ä¸‹æ¥çš„å†…å­˜åˆ†é…å™¨ä¹‹å‰ï¼Œå†…æ ¸å¯ä»¥æä¾›ä¸€äº›æ‰‹æ®µæ¥ä¿®æ”¹ E820 Table è¡¨æ¥æ§åˆ¶æœªæ¥ç³»ç»Ÿçš„å†… å­˜å¸ƒå±€ï¼Œè¿™ç§ä¿®æ”¹æ¯”è¾ƒå¸¸è§çš„å°±æ˜¯ç»™ç³»ç»Ÿ CMDLINE æœºåˆ¶æä¾›é€‰é¡¹ï¼Œå®ç°æŸæ®µåŒºåŸŸçš„é¢„ç•™ï¼Œæˆ–è€…æ§åˆ¶ç³»ç»Ÿå¯ç”¨ç‰©ç†å†…å­˜çš„é•¿åº¦ç­‰åŠŸèƒ½ã€‚</p><p>E820 å†…å­˜ç®¡ç†å™¨æä¾›äº† <code>memmap=</code> å’Œ <code>mem=</code> é€‰é¡¹ï¼Œç”¨äºç”¨æˆ·æ·»åŠ æˆ–ä¿®æ”¹ E820 å†…å­˜åŒºåŸŸã€‚é€šè¿‡è¿™äº›é€‰é¡¹ï¼Œç”¨æˆ·å¯ä»¥ç®€å•çš„æ·»åŠ ä¸€å— â€œç³»ç»Ÿé¢„ç•™åŒºåŸŸâ€ã€ â€œACPI Data åŒºåŸŸâ€ã€â€ç³»ç»Ÿä¿æŠ¤åŒºåŸŸâ€ï¼Œæˆ–è€…å¯ä»¥ä¿®æ”¹ e820_table ä¸­æŸæ®µå†…å­˜åŒºåŸŸçš„ç±»å‹ã€‚ è¿™äº› cmdline é€‰é¡¹è¿˜å¯ä»¥ä¿®æ”¹ç³»ç»Ÿæœ€å¤§å¯ç”¨ç‰©ç†å†…å­˜æˆ–è€…ç³»ç»Ÿå¯ä»¥ä½¿ç”¨çš„ç‰©ç†å†…å­˜èŒƒå›´ã€‚</p><div class="language-cpp line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* arch/x86/kernel/e820.c */</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">early_param</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;mem&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, parse_memopt);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">early_param</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;memmap&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, parse_memmap_opt);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><details><summary>Documentation/admin-guide/kernel-parameters.txt</summary><p>è¿™é‡Œçš„ nn æ˜¯æŒ‡ Sizeï¼Œss åˆ™æ˜¯æŒ‡ Address ï¼Ÿ</p><div class="language-txt line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>  mem=nn[KMG]  [KNL,BOOT,EARLY] Force usage of a specific amount</span></span>
<span class="line"><span>      of memory Amount of memory to be used in cases</span></span>
<span class="line"><span>      as follows:</span></span>
<span class="line"><span></span></span>
<span class="line"><span>      1 for test;</span></span>
<span class="line"><span>      2 when the kernel is not able to see the whole system memory;</span></span>
<span class="line"><span>      3 memory that lies after &#39;mem=&#39; boundary is excluded from</span></span>
<span class="line"><span>       the hypervisor, then assigned to KVM guests.</span></span>
<span class="line"><span>      4 to limit the memory available for kdump kernel.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>      [ARC,MICROBLAZE] - the limit applies only to low memory,</span></span>
<span class="line"><span>      high memory is not affected.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>      [ARM64] - only limits memory covered by the linear</span></span>
<span class="line"><span>      mapping. The NOMAP regions are not affected.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>      [X86] Work as limiting max address. Use together</span></span>
<span class="line"><span>      with memmap= to avoid physical address space collisions.</span></span>
<span class="line"><span>      Without memmap= PCI devices could be placed at addresses</span></span>
<span class="line"><span>      belonging to unused RAM.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>      Note that this only takes effects during boot time since</span></span>
<span class="line"><span>      in above case 3, memory may need be hot added after boot</span></span>
<span class="line"><span>      if system memory of hypervisor is not sufficient.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  memmap=exactmap  [KNL,X86,EARLY] Enable setting of an exact</span></span>
<span class="line"><span>      E820 memory map, as specified by the user.</span></span>
<span class="line"><span>      Such memmap=exactmap lines can be constructed based on</span></span>
<span class="line"><span>      BIOS output or other requirements. See the memmap=nn@ss</span></span>
<span class="line"><span>      option description.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  memmap=nn[KMG]@ss[KMG]</span></span>
<span class="line"><span>      [KNL, X86,MIPS,XTENSA,EARLY] Force usage of a specific region of memory.</span></span>
<span class="line"><span>      Region of memory to be used is from ss to ss+nn.</span></span>
<span class="line"><span>      If @ss[KMG] is omitted, it is equivalent to mem=nn[KMG],</span></span>
<span class="line"><span>      which limits max address to nn[KMG].</span></span>
<span class="line"><span>      Multiple different regions can be specified,</span></span>
<span class="line"><span>      comma delimited.</span></span>
<span class="line"><span>      Example:</span></span>
<span class="line"><span>        memmap=100M@2G,100M#3G,1G!1024G</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  memmap=nn[KMG]#ss[KMG]</span></span>
<span class="line"><span>      [KNL,ACPI,EARLY] Mark specific memory as ACPI data.</span></span>
<span class="line"><span>      Region of memory to be marked is from ss to ss+nn.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  memmap=nn[KMG]$ss[KMG]</span></span>
<span class="line"><span>      [KNL,ACPI,EARLY] Mark specific memory as reserved.</span></span>
<span class="line"><span>      Region of memory to be reserved is from ss to ss+nn.</span></span>
<span class="line"><span>      Example: Exclude memory from 0x18690000-0x1869ffff</span></span>
<span class="line"><span>               memmap=64K$0x18690000</span></span>
<span class="line"><span>               or</span></span>
<span class="line"><span>               memmap=0x10000$0x18690000</span></span>
<span class="line"><span>      Some bootloaders may need an escape character before &#39;$&#39;,</span></span>
<span class="line"><span>      like Grub2, otherwise &#39;$&#39; and the following number</span></span>
<span class="line"><span>      will be eaten.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  memmap=nn[KMG]!ss[KMG,EARLY]</span></span>
<span class="line"><span>      [KNL,X86] Mark specific memory as protected.</span></span>
<span class="line"><span>      Region of memory to be used, from ss to ss+nn.</span></span>
<span class="line"><span>      The memory region may be marked as e820 type 12 (0xc)</span></span>
<span class="line"><span>      and is NVDIMM or ADR memory.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  memmap=&lt;size&gt;%&lt;offset&gt;-&lt;oldtype&gt;+&lt;newtype&gt;</span></span>
<span class="line"><span>      [KNL,ACPI,EARLY] Convert memory within the specified region</span></span>
<span class="line"><span>      from &lt;oldtype&gt; to &lt;newtype&gt;. If &quot;-&lt;oldtype&gt;&quot; is left</span></span>
<span class="line"><span>      out, the whole region will be marked as &lt;newtype&gt;,</span></span>
<span class="line"><span>      even if previously unavailable. If &quot;+&lt;newtype&gt;&quot; is left</span></span>
<span class="line"><span>      out, matching memory will be removed. Types are</span></span>
<span class="line"><span>      specified as e820 types, e.g., 1 = RAM, 2 = reserved,</span></span>
<span class="line"><span>      3 = ACPI, 12 = PRAM.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div></details><p><code>mem=nn[KMG]</code> å‚æ•°ç”¨äºæŒ‡æ˜ç³»ç»Ÿæœ€å¤§å¯ç”¨ç‰©ç†å†…å­˜çš„é•¿åº¦ï¼Œå³ç³»ç»Ÿå¯ç”¨ç‰©ç†å†…å­˜èŒƒå›´æ˜¯ â€œ0-nnâ€, è¶…è¿‡è¿™ä¸€é•¿åº¦çš„ç‰©ç†å†…å­˜ç³»ç»Ÿå°†ä¸å¯è§ã€‚</p><p><code>memmap=</code> å¯ä»¥ç”¨æ¥ï¼š</p><ul><li>å¼ºåˆ¶ä½¿ç”¨æŸæ®µå†…å­˜ <code>memmap=nn@ss</code></li><li>é¢„ç•™ä¸€æ®µ ACPI data åŒºåŸŸ <code>memmap=nn#ss</code></li><li>é¢„ç•™ä¸€æ®µç‰©ç†å†…å­˜ <code>memmap=nn$ss</code></li><li>é¢„ç•™ä¸€æ®µä¿æŠ¤åŒºåŸŸ <code>memmap=nn!ss</code> ä¸€èˆ¬ç»™ NVDIMM å’Œ ADR å†…å­˜ä½¿ç”¨</li><li>ä¿®æ”¹ä¸€æ®µå†…å­˜åŒºåŸŸçš„ç±»å‹ <code>memmap=&lt;size&gt;%&lt;offset&gt;-&lt;oldtype&gt;+&lt;newtype&gt;</code> type è§ enum e820_type</li></ul><p>ä¸€èˆ¬ â€œmem=â€ å’Œ â€œmemmap=â€ é…åˆä½¿ç”¨ï¼Œä»¥æ­¤é¿å…ç‰©ç†ç©ºé—´å†²çªã€‚å¦‚æœè®¾ç½®äº†æœ€å¤§ç‰©ç†å¯ç”¨å†…å­˜ä¹‹åï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨ â€œmemmap=â€ è¿›è¡Œ â€œACPIâ€ åŒºåŸŸçš„è®¾ç½®ï¼Œé‚£ä¹ˆ â€œACPIâ€ åŒºåŸŸå°†è®¾ç½®ä¸ºä¸å¯ç”¨çš„ RAM åŒºåŸŸã€‚ TODO ã€Œâ€œACPIâ€ åŒºåŸŸå°†è®¾ç½®ä¸ºä¸å¯ç”¨çš„ RAM åŒºåŸŸã€æ€ä¹ˆç†è§£ï¼Ÿ</p><p>å¯åŠ¨ 8G è™šæ‹Ÿæœºï¼Œä½†æ˜¯å¸¦ <code>mem=6G memmap=1M$0x20000000,1M!0x20100000</code>å‚æ•°ï¼Œ</p><div class="language-log line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">log</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] BIOS-provided physical RAM map:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] BIOS-e820: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x0000000000000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x000000000009fbff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] usable</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] BIOS-e820: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x000000000009fc00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000000fffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] reserved</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># å·®ä¸å¤š 2GB</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] BIOS-e820: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x0000000000100000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x000000007ffdffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] usable</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] BIOS-e820: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x000000007ffe0000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x000000007fffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] reserved</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] BIOS-e820: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000b0000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000bfffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] reserved</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] BIOS-e820: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000fed1c000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000fed1ffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] reserved</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] BIOS-e820: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000feffc000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000feffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] reserved</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] BIOS-e820: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000fffc0000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000ffffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] reserved</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># 4GB-10GB ä¹Ÿå°±æ˜¯ 6GB å¤§å°çš„åŒºåŸŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] BIOS-e820: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x0000000100000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x000000027fffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] usable</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># e820__finish_early_params å‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰ mem= æˆ– memmap= å‚æ•°ï¼Œæ˜¯æ²¡æœ‰è¿™ä¸€æ®µæ¶ˆæ¯çš„ï¼š</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] user-defined physical RAM map:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] user: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x0000000000000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x000000000009fbff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] usable</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] user: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x000000000009fc00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000000fffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] reserved</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] user: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x0000000000100000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x000000001fffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] usable</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># 1M$</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x20000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> é¢„ç•™çš„ç‰©ç†å†…å­˜</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] user: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x0000000020000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000200fffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] reserved</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># 1M!</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x20100000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> é¢„ç•™çš„ä¿æŠ¤åŒºåŸŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] user: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x0000000020100000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000201fffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] persistent (type </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] user: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x0000000020200000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x000000007ffdffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] usable</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] user: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x000000007ffe0000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x000000007fffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] reserved</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] user: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000b0000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000bfffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] reserved</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] user: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000fed1c000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000fed1ffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] reserved</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] user: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000feffc000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000feffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] reserved</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] user: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000fffc0000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x00000000ffffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] reserved</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># å¯ä»¥çœ‹åˆ°è¿™é‡Œç›¸æ¯”ä¸ e820 tableï¼Œå˜æˆäº† 4GB-6GBï¼Œä¹Ÿå°±æ˜¯ 2GB å¤§å°çš„åŒºåŸŸ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># è¯´æ˜ mem=6G è®©ç‰©ç†åœ°å€ 6G ä»¥ä¸Šçš„éƒ½ä¸å¯è§äº†ï¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] user: [mem </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x0000000100000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x000000017fffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] usable</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">~ # cat /proc/iomem</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00000000-00000fff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : Reserved</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00001000-0009fbff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : System RAM</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0009fc00-000fffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : Reserved</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  000a0000-000bffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : PCI Bus </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0000:00</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  000c0000-000c7fff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : Video ROM</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  000f0000-000fffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : System ROM</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00100000-1fffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : System RAM</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  01000000-023fffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : Kernel code</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  02400000-0354afff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : Kernel rodata</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  03600000-0396b63f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : Kernel data</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  042bc000-047fffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : Kernel bss</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">#</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20000000-200fffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : Reserved</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">#</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20100000-201fffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : Persistent Memory (legacy)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20200000-7ffdffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : System RAM</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7ffe0000-7fffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : Reserved</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># 2G ~ 4G</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80000000-afffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : PCI Bus </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0000:00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> # è¿™éƒ¨åˆ†æ²¡åœ¨ e820 table é‡Œå‡ºç°</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">b0000000-bfffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : PCI ECAM </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [bus </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00-ff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  b0000000-bfffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : Reserved</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    b0000000-bfffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : pnp </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">00:04</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">c0000000-febfffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : PCI Bus </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0000:00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> # è¿™éƒ¨åˆ†æ²¡åœ¨ e820 table é‡Œå‡ºç°</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fec00000-fec003ff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : IOAPIC </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fed00000-fed003ff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : HPET </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  fed00000-fed003ff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : PNP01</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">03:00</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fed1c000-fed1ffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : Reserved</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  fed1f410-fed1f414</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">iTCO_wdt.0.auto</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">feffc000-feffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : Reserved</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fffc0000-ffffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : Reserved</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># 4G ~ 6G</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100000000-17fffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : System RAM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># 6G ~ 10G æ²¡æœ‰å‡ºç°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># 10G ~ ...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">280000000-a7fffffff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : PCI Bus </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0000:00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> # è¿™éƒ¨åˆ†æ²¡åœ¨ e820 table é‡Œå‡ºç°</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div>`,41)])])}const m=a(e,[["render",l]]);export{c as __pageData,m as default};
